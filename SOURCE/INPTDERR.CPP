/*
 * InptDErr - Errors messages module -------------------------
 *
 * Author: Konstantin A. Davidov
 *	   Crimea Engineering Centre
 *	   Phone: (06557) 68-2-39
 * -------------------------------------------------------------
 *    InptDErr  -  Модуль выдачи сообщений об ошибках при работе
 *		функций коммуникации с контроллером.
 */
#include <stdlib.h>
#include <string.h>
#include <windows.h>

#include "ibus902c.h"
#include "messagew.h"
struct Message {
	char name[20];
	int  code;
	char msg[250];
};

Message MessageBuffer [] = {
	{"INIT_NETWORK",	ERR_ST_ADR, 	"Неразрешенный адрес станции"},
	{"INIT_NETWORK", 	ERR_SPEED,  	"Неразрешенный код скорости"},
	{"INIT_NETWORK", 	ERR_ST_LIST, 	"Неразрешенный список активных станций"},
	{"INIT_NETWORK", 	ERR_INIT,	"Инициализация сети не удалась"},
	{"INIT_NETWORK", 	ERR_NO_IBUS, 	"Не установлен IBUS модуль сопряжения"},
	{"INIT_NETWORK", 	ERR_ADR_IBUS, 	"Неразрешенный адрес IBUS модуля"},
	{"WRITE_STATION_LIST", 	REQUEST_CFG,	"Запрос на конфигурацию сети отослан сетевому процессору"},
	{"WRITE_STATION_LIST", 	ERR_ST_SLAVE,	"Станция не является ведущей"},
	{"WRITE_STATION_LIST", 	ERR_ST_LIST,	"Неразрешенный список активных станций"},
	{"WRITE_STATION_LIST", 	ERR_NO_IBUS,	"Не установлен IBUS модуль сопряжения"},
	{"WRITE_STATION_LIST", 	ERR_ADR_IBUS,	"Неразрешенный адрес IBUS модуля"},
	{"RESET_44", 		ERR_NO_IBUS,	"Не установлен IBUS модуль сопряжения"},
	{"RESET_44", 		ERR_ADR_IBUS,	"Неразрешенный адрес IBUS модуля"},
	{"CONFIGURE_SAP", 	ERR_LSAP,	"Неразрешенный логический адрес"},
	{"CONFIGURE_SAP", 	ERR_COMM,	"Неразрешенный параметр коммуникации"},
	{"CONFIGURE_SAP", 	ERR_RDR,	"Неразрешенный параметр RDR услуги"},
	{"CONFIGURE_SAP", 	ERR_NUM_BUFF,	"Недопускаемое запрошенное число буферов"},
	{"CONFIGURE_SAP", 	ERR_CFG_LSAP,	"Нет конфигурации активного логического адреса"},
	{"CONFIGURE_SAP", 	ERR_ADR_IBUS,	"Неразрешенный адрес IBUS модуля"},
	{"ACTIVATE_SAP", 	ERR_LSAP_ACT,	"Логический адрес уже активен"},
	{"ACTIVATE_SAP", 	ERR_LSAP_CFG,	"Логический адрес незаконфигурирован"},
	{"ACTIVATE_SAP", 	ERR_LSAP,	"Неразрешенный логический адрес"},
	{"ACTIVATE_SAP", 	ERR_ADR_IBUS,	"Неразрешенный адрес IBUS модуля"},
	{"DEACTIVATE_SAP", 	ERR_LSAP_CFG,	"Логический адрес незаконфигурирован"},
	{"DEACTIVATE_SAP", 	ERR_LSAP_DACT,	"Логический адрес уже неактивен"},
	{"DEACTIVATE_SAP", 	ERR_LSAP,	"Неразрешенный логический адрес"},
	{"DEACTIVATE_SAP", 	ERR_ADR_IBUS,	"Неразрешенный адрес IBUS модуля"},
	{"CONNECT_SAP",		ERR_ACT_LSAP,	"Локальный логический адрес не активизирован"},
	{"CONNECT_SAP", 	ERR_RADR,	"Недопускаемый физический адрес станции"},
	{"CONNECT_SAP", 	ERR_RSAP,	"Недопускаемый логический адрес удаленной станции"},
	{"CONNECT_SAP", 	ERR_LSAP_CON,	"Логический адрес уже привязан"},
	{"CONNECT_SAP", 	ERR_LSAP_NCON, 	"Логический адрес не законфигурирован для коммуникации с установлением связи"},
	{"DISCONNECT_SAP",	ERR_ACT_LSAP,	"Локальный логический адрес не активизирован"},
	{"DISCONNECT_SAP",	ERR_LSAP_NCON,  "Логический адрес не законфигурирован для коммуникации с установлением связи"},
	{"DISCONNECT_SAP",	ERR_LSAP_NNET,	"Логический адрес не имеет установленной связи"},
	{"SEND_DATA_ACK",	ERR_ACT_LSAP,	"Локальный логический адрес не активизирован"},
	{"SEND_DATA_ACK",	ERR_LSAP_REZ,	"Логический адрес локальной станции резервирован под локальные функции"},
	{"SEND_DATA_ACK",	ERR_LSAP_NNET,  "Логический адрес локальной станции законфигурирован для коммуникаций с установлением логической связи, а связи нет"},
	{"SEND_DATA_ACK",	ERR_RSAP_NNET,	"Параметр логического адреса удаленной станции несоответствует логическому адресу локальной определенный для коммуникации с устанавливанием логической связи, а связь не установлена заданным параметром логического адреса удаленной станции"},
	{"SEND_DATA_ACK",	ERR_RADR_NNET,	"Параметр физического адреса удаленной станции несоответствует логическому адресу локальной определенный для коммуникации с устанавливанием логической связи, а связь не установлена заданным или неразрешенное значение физического адреса"},
	{"SEND_DATA_ACK",	ERR_NO_BUF,	"Нет в распоряжении внутреннего буфера для хранения запроса"},
	{"SEND_DATA_ACK",	ERR_UP_BUF,	"Переполнено общее число внутренних буферов резервированное для данной локальной станции"},
	{"SEND_DATA_ACK",	ERR_PRIOR,	"Неразрешенный приоритет"},
	{"SEND_DATA_ACK",	ERR_NDATA,	"Неразрешенная длина данных"},
	{"SEND_DATA",		ERR_ACT_LSAP,	"Локальный логический адрес не активизирован"},
	{"SEND_DATA",		ERR_LSAP_REZ,	"Логический адрес локальной станции резервирован под локальные функции"},
	{"SEND_DATA",		ERR_LSAP_NNET,  "Логический адрес локальной станции законфигурирован для коммуникаций с установлением логической связи, а связи нет"},
	{"SEND_DATA",		ERR_RSAP_NNET,	"Параметр логического адреса удаленной станции несоответствует логическому адресу локальной определенный для коммуникации с устанавливанием логической связи, а связь не установлена заданным параметром логического адреса удаленной станции"},
	{"SEND_DATA",		ERR_RADR_NNET,	"Параметр физического адреса удаленной станции несоответствует логическому адресу локальной определенный для коммуникации с устанавливанием логической связи, а связь не установлена заданным или неразрешенное значение физического адреса"},
	{"SEND_DATA",		ERR_NO_BUF,	"Нет в распоряжении внутреннего буфера для хранения запроса"},
	{"SEND_DATA",		ERR_UP_BUF,	"Переполнено общее число внутренних буферов резервированное для данной локальной станции"},
	{"SEND_DATA",		ERR_PRIOR,	"Неразрешенный приоритет"},
	{"SEND_DATA",		ERR_NDATA,	"Неразрешенная длина данных"},
	{"UPDATE_REQUEST",	ERR_ACT_LSAP,	"Локальный логический адрес не активизирован"},
	{"UPDATE_REQUEST",	ERR_LSAP_REZ,	"Логический адрес локальной станции резервирован под локальные функции"},
	{"UPDATE_REQUEST",	ERR_LSAP_NNET,  "Логический адрес локальной станции законфигурирован для коммуникаций с установлением логической связи, а связи нет"},
	{"UPDATE_REQUEST",	ERR_RSAP_NNET,	"Параметр логического адреса удаленной станции несоответствует логическому адресу локальной определенный для коммуникации с устанавливанием логической связи, а связь не установлена заданным параметром логического адреса удаленной станции"},
	{"UPDATE_REQUEST",	ERR_RADR_NNET,	"Параметр физического адреса удаленной станции несоответствует логическому адресу локальной определенный для коммуникации с устанавливанием логической связи, а связь не установлена заданным или неразрешенное значение физического адреса"},
	{"UPDATE_REQUEST",	ERR_NO_BUF,	"Нет в распоряжении внутреннего буфера для хранения запроса"},
	{"UPDATE_REQUEST",	ERR_UP_BUF,	"Переполнено общее число внутренних буферов резервированное для данной локальной станции"},
	{"UPDATE_REQUEST",	ERR_PRIOR,	"Неразрешенный приоритет"},
	{"UPDATE_REQUEST",	ERR_NDATA,	"Неразрешенная длина данных"},
	{"UPDATE_REQUEST",	ERR_LSAP_RDR,	"Локальная станция не законфигурирована для RDR услуг"},
	{"GET_CONFIRM",		ERR_R_CONFIRM,	"Нет подтверждения от удаленной стании"},
	{"GET_CONFIRM",		ERR_RSAP_CFG,	"Удаленный логический адрес незаконфигурирован"},
	{"GET_CONFIRM",		ERR_R_RESOURC,	"Недостаточные ресурсы удаленной станции"}
};

void
InptDErr(const char * ProcName, int RetCode)
{
int MessageSize = (sizeof (MessageBuffer) / sizeof(MessageBuffer[0]));
int i;
for (i = 0; i < MessageSize; i++)
  {
	 if (MessageBuffer[i].name == ProcName || MessageBuffer[i].code == RetCode)
	 {
		  MessageW(ProcName, MessageBuffer[i].msg);
		  break;
	 };
  }
}
/*
 * ---------------------------------------------------------
 *	EoF(inptderr.cpp)
 * ----------------------------------------------------------
 */
